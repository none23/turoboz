"use strict";function switchActiveNavLink(e){e.className.indexOf("active")===-1&&(e.parentNode.querySelector(".site_nav__link.active").classList.remove("active"),e.classList.add("active"),document.activeElement.blur())}function useAppCache(){function e(){t.swapCache(),changePage(document.URL)}var t=window.applicationCache;t.addEventListener("updateready",e),t.status===t.UPDATEREADY&&e(),setInterval(function(){t.update()},3e5)}function toggleMobileNav(){mobile_nav_toggle.classList.toggle("is_open"),mobile_nav.classList.toggle("is_open")}function callBackFormToggle(){for(var e=document.getElementsByClassName("call_back_form__toggle"),t=document.getElementById("call_back_form__wrap"),n=document.querySelector("#site_contacts_wrap .call_back_form__toggle"),o=0;o<e.length;o++)e[o].addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),n&&n.classList.toggle("is_open"),t.classList.toggle("is_open"),t.classList.contains("is_open")&&document.getElementById("call_back_form__name").focus()})}function enableForm(e,t){var n=e+"_form",o=e+"_form__button",a=document.getElementById(n),i=document.getElementById(o);return function(){a&&a.addEventListener("submit",function(e){return e.preventDefault(),iSendAJAX(e,a,i,t)})}}function iSendAJAX(e,t,n,o){var a,i;return i=new XMLHttpRequest,i.open("POST","//formspree.io/n.anisimov.23@gmail.com",!0),i.setRequestHeader("accept","application/json"),a=new FormData(t),i.send(a),n.className="form__button--loading",n.textContent="Отправка...",i.onreadystatechange=function(){4==i.readyState&&(200==i.status?(n.textContent=o,n.className="form__button--success"):(n.textContent="Возникла ошибка при отправке.",n.className="form__button--failure"))}}var html=document.documentElement,mobile_nav_toggle=document.getElementById("mobile_nav_toggle"),mobile_nav=document.getElementById("mobile_nav"),desktop_nav=document.getElementById("desktop_nav"),pageContentWrap="page_content_wrap",changePage=function(e){var t=new XMLHttpRequest;t.open("GET",e),t.responseType="document",t.onload=function(){var e=this.response.getElementById(pageContentWrap),t=document.getElementById(pageContentWrap),n=this.response.querySelector("title"),o=document.querySelector("title"),a=this.response.getElementById("pageDescription"),i=document.getElementById("pageDescription"),r=function(){t.parentNode.replaceChild(e,t),o.parentNode.replaceChild(n,o),i.parentNode.replaceChild(a,i),window.scrollTo(0,0),mobile_nav.classList.contains("is_open")&&toggleMobileNav()};if(t.animate){var c=t.animate({opacity:[1,0]},200);c.onfinish=r()}else r()},t.send()};!function(){history&&history.pushState&&(document.addEventListener("click",function(e){if(!e.ctrlKey){for(var t=e.target;t&&!t.href;)t=t.parentNode;if(t){if("_blank"==t.target)return;if(t.href.indexOf("tel:")>=0)return;if(t.href.indexOf("mailto:")>=0)return;if("mobile_nav_toggle"===t.id)return;return e.preventDefault(),changePage(t.href),history.pushState(null,null,t.href),void(window.ga&&(window.ga("set","page",t.href),window.ga("send","pageview")))}}}),setTimeout(function(){window.onpopstate=function(){changePage(window.location.href)}},500))}(),function(){desktop_nav.addEventListener("click",function(e){switchActiveNavLink(e.target)}),mobile_nav.addEventListener("click",function(e){switchActiveNavLink(e.target)})}(),function(){"serviceWorker"in navigator?navigator.serviceWorker.register("/serviceworker.js"):(html.setAttribute("manifest","/turoboz.appcache"),useAppCache())}(),function(){mobile_nav_toggle.addEventListener("click",function(e){e.preventDefault(),toggleMobileNav()})}();var enableCallBackForm=enableForm("call_back","Форма успешно отправлена! Мы свяжемся с Вами в ближайшее время."),enableContactForm=enableForm("contact","Форма успешно отправлена! Мы свяжемся с Вами в ближайшее время."),enableReviewForm=enableForm("review","Спасибо! Отзыв принят и будет опубликован после проверки."),enableOrderForm=enableForm("order","Форма успешно отправлена! Мы свяжемся с Вами в ближайшее время для уточнения деталей.");!function(){window.addEventListener("DOMContentLoaded",function(){callBackFormToggle(),enableCallBackForm(),enableContactForm(),enableReviewForm(),enableOrderForm()})}();
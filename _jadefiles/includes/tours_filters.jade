mixin ToursNavPrimary()
    | {% for nptag in site.data.tags %}
    a(href='{{ nptag.url }}', class='tours_nav__link {% if page.url contains nptag.url %}active{% endif %}', id='tag_toggle--{{ nptag.tag }}')
        | {{ nptag.title }}
    | {% endfor %}

mixin ToursNavSecondary()
    a.tours_nav__link--back(href='{{ tag.url }}') 
        svg(viewbox='0 0 20 20')
            title назад
            path.tours_nav__link--back__svg(d='M2.5,10L9,3.5V7h8v6H9v3.5L2.5,10z')
    | {% for nssubtag in tag.subtags %}
    a(href='{{ nssubtag.url }}', class='tours_nav__link {% if page.url contains nssubtag.url %}active{% endif %}', id='tag_toggle--{{ nssubtag.subtag }}')
        | {{ nssubtag.title }}
    | {% endfor %}

section.tours_nav__wrap
    h2.section_header
        | Категории
    | {% if page.url == '/tours/' %}
    //-- no tag selected => show only primary, TODO: hide all secondary (for animations)
    nav#tours_nav--primary.tours_nav
        +ToursNavPrimary()
    | {% else %}
    | {% for tatag in site.data.tags %}
    | {% if page.url contains tatag.url %}
    | {% if tatag.subtags %}
    //-- a tag containing subtags selected => show secondary and (minimized) primary 
    nav#tours_nav--primary.tours_nav--minified
        +ToursNavPrimary()
    nav.tours_nav(id='tours_nav--{{ tatag.tag }}', class='tours_nav--{{ tatag.tag }}')
        +ToursNavSecondary()
    | {% else %}
    //-- a tag containing no subtags selected =>  show only primary, TODO: hide all secondary (for animations)
    nav#tours_nav--primary.tours_nav
        +ToursNavPrimary()
    | {% endif %}
    | {% endif %}
    | {% endfor %}
    | {% endif %}

